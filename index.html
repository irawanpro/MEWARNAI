<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Game Mewarnai Buah</title>
<style>
    html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
        background: #f0f0f0;
        touch-action: none;
    }
    #gameContainer {
        position: relative;
        width: 100%;
        height: 100%;
        background: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }
    #canvasWrapper {
        position: relative;
        flex: 1;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: white;
    }
    canvas {
        position: absolute;
        max-width: 100%;
        max-height: 100%;
    }
    #palette {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        padding: 5px;
        background: #ddd;
    }
    .colorBtn {
        width: 30px;
        height: 30px;
        margin: 3px;
        border-radius: 50%;
        border: 2px solid #fff;
        cursor: pointer;
    }
    #controls {
        display: flex;
        justify-content: center;
        padding: 10px;
        background: #ccc;
    }
    button {
        margin: 0 5px;
        padding: 8px 16px;
        font-size: 16px;
        border: none;
        border-radius: 6px;
        background: #4CAF50;
        color: white;
        cursor: pointer;
    }
    button:hover {
        background: #45a049;
    }
</style>
</head>
<body>

<div id="gameContainer">
    <div id="canvasWrapper">
        <canvas id="colorCanvas"></canvas>
        <canvas id="outlineCanvas"></canvas>
    </div>
    <div id="palette"></div>
    <div id="controls">
        <button id="prevBtn">Prev</button>
        <button id="resetBtn">Reset</button>
        <button id="nextBtn">Next</button>
    </div>
</div>

<script>
const fruits = [
    "apel.png", "jeruk.png", "anggur.png", "kiwi_emas.png", "pisang.png",
    "pir.png", "mangga.png", "nanas.png", "semangka.png", "pepaya.png",
    "melon.png", "alpukat.png", "timun.png", "terong.png", "labu_siam.png",
    "cabai.png", "tomat.png", "paprika.png", "zukini.png", "kentang.png"
].map(f => "assets/images/" + f);

const colorCanvas = document.getElementById("colorCanvas");
const outlineCanvas = document.getElementById("outlineCanvas");
const colorCtx = colorCanvas.getContext("2d");
const outlineCtx = outlineCanvas.getContext("2d");

let currentFruitIndex = 0;
let isDrawing = false;
let currentColor = "#000000";
let lastX = 0, lastY = 0;

// Resize canvases to fill wrapper
function resizeCanvas() {
    const wrapper = document.getElementById("canvasWrapper");
    const w = wrapper.clientWidth;
    const h = wrapper.clientHeight;
    colorCanvas.width = outlineCanvas.width = w;
    colorCanvas.height = outlineCanvas.height = h;
    loadFruit(currentFruitIndex);
}
window.addEventListener("resize", resizeCanvas);

// Load fruit outline image
function loadFruit(index) {
    colorCtx.clearRect(0, 0, colorCanvas.width, colorCanvas.height);
    outlineCtx.clearRect(0, 0, outlineCanvas.width, outlineCanvas.height);
    const img = new Image();
    img.src = fruits[index];
    img.onload = () => {
        outlineCtx.drawImage(img, 0, 0, outlineCanvas.width, outlineCanvas.height);
    };
}

// Drawing events
function startDrawing(x, y) {
    isDrawing = true;
    lastX = x;
    lastY = y;
}
function draw(x, y) {
    if (!isDrawing) return;
    colorCtx.strokeStyle = currentColor;
    colorCtx.lineWidth = 20;
    colorCtx.lineCap = "round";
    colorCtx.beginPath();
    colorCtx.moveTo(lastX, lastY);
    colorCtx.lineTo(x, y);
    colorCtx.stroke();
    lastX = x;
    lastY = y;
}
function stopDrawing() {
    isDrawing = false;
}

// Mouse events
colorCanvas.addEventListener("mousedown", e => startDrawing(e.offsetX, e.offsetY));
colorCanvas.addEventListener("mousemove", e => draw(e.offsetX, e.offsetY));
colorCanvas.addEventListener("mouseup", stopDrawing);
colorCanvas.addEventListener("mouseout", stopDrawing);

// Touch events
colorCanvas.addEventListener("touchstart", e => {
    const rect = colorCanvas.getBoundingClientRect();
    startDrawing(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top);
});
colorCanvas.addEventListener("touchmove", e => {
    e.preventDefault();
    const rect = colorCanvas.getBoundingClientRect();
    draw(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top);
});
colorCanvas.addEventListener("touchend", stopDrawing);

// Palette colors
const colors = ["#000000", "#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#FF00FF", "#00FFFF",
    "#FFA500", "#800080", "#008000", "#A52A2A", "#808000", "#FFC0CB", "#FFFFFF"];
const paletteDiv = document.getElementById("palette");
colors.forEach(col => {
    const btn = document.createElement("div");
    btn.className = "colorBtn";
    btn.style.background = col;
    btn.addEventListener("click", () => currentColor = col);
    paletteDiv.appendChild(btn);
});

// Buttons
document.getElementById("nextBtn").addEventListener("click", () => {
    currentFruitIndex = (currentFruitIndex + 1) % fruits.length;
    loadFruit(currentFruitIndex);
});
document.getElementById("prevBtn").addEventListener("click", () => {
    currentFruitIndex = (currentFruitIndex - 1 + fruits.length) % fruits.length;
    loadFruit(currentFruitIndex);
});
document.getElementById("resetBtn").addEventListener("click", () => {
    colorCtx.clearRect(0, 0, colorCanvas.width, colorCanvas.height);
});

// Init
resizeCanvas();
</script>

</body>
</html>
